{"id":"node_modules/@sentry/core/build/esm/metrics/metric-summary.js","dependencies":[{"name":"F:\\urban\\Все работы\\module 9\\node_modules\\@sentry\\core\\build\\esm\\metrics\\metric-summary.js.map","includedInParent":true,"mtime":1723907473438},{"name":"F:\\urban\\Все работы\\module 9\\package.json","includedInParent":true,"mtime":1723907516383},{"name":"F:\\urban\\Все работы\\module 9\\node_modules\\@sentry\\core\\build\\esm\\package.json","includedInParent":true,"mtime":1723907471223},{"name":"@sentry/utils","loc":{"line":1,"column":34,"index":34},"parent":"F:\\urban\\Все работы\\module 9\\node_modules\\@sentry\\core\\build\\esm\\metrics\\metric-summary.js","resolved":"F:\\urban\\Все работы\\module 9\\node_modules\\@sentry\\utils\\build\\esm\\index.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getMetricSummaryJsonForSpan = getMetricSummaryJsonForSpan;\nexports.updateMetricSummaryOnSpan = updateMetricSummaryOnSpan;\nvar _utils = require(\"@sentry/utils\");\n/**\n * key: bucketKey\n * value: [exportKey, MetricSummary]\n */\n\nconst METRICS_SPAN_FIELD = '_sentryMetrics';\n\n/**\n * Fetches the metric summary if it exists for the passed span\n */\nfunction getMetricSummaryJsonForSpan(span) {\n  const storage = span[METRICS_SPAN_FIELD];\n  if (!storage) {\n    return undefined;\n  }\n  const output = {};\n  for (const [, [exportKey, summary]] of storage) {\n    const arr = output[exportKey] || (output[exportKey] = []);\n    arr.push((0, _utils.dropUndefinedKeys)(summary));\n  }\n  return output;\n}\n\n/**\n * Updates the metric summary on a span.\n */\nfunction updateMetricSummaryOnSpan(span, metricType, sanitizedName, value, unit, tags, bucketKey) {\n  const existingStorage = span[METRICS_SPAN_FIELD];\n  const storage = existingStorage || (span[METRICS_SPAN_FIELD] = new Map());\n  const exportKey = `${metricType}:${sanitizedName}@${unit}`;\n  const bucketItem = storage.get(bucketKey);\n  if (bucketItem) {\n    const [, summary] = bucketItem;\n    storage.set(bucketKey, [exportKey, {\n      min: Math.min(summary.min, value),\n      max: Math.max(summary.max, value),\n      count: summary.count += 1,\n      sum: summary.sum += value,\n      tags: summary.tags\n    }]);\n  } else {\n    storage.set(bucketKey, [exportKey, {\n      min: value,\n      max: value,\n      count: 1,\n      sum: value,\n      tags\n    }]);\n  }\n}"},"sourceMaps":{"js":{"mappings":[{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":7,"column":0},"generated":{"line":9,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":10,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":11,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":10,"column":0},"generated":{"line":12,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":13,"column":0},"generated":{"line":14,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":13,"column":6},"generated":{"line":14,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":13,"column":6},"generated":{"line":14,"column":24}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":13,"column":27},"generated":{"line":14,"column":27}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":13,"column":43},"generated":{"line":14,"column":43}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":19,"column":0},"generated":{"line":16,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":20,"column":0},"generated":{"line":17,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":21,"column":0},"generated":{"line":18,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":22,"column":7},"generated":{"line":19,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":19,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":22,"column":43},"generated":{"line":19,"column":36}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":22,"column":44},"generated":{"line":19,"column":37}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":22,"column":48},"generated":{"line":19,"column":41}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":22,"column":106},"generated":{"line":19,"column":43}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":2},"generated":{"line":20,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":8},"generated":{"line":20,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":8},"generated":{"line":20,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":19},"generated":{"line":20,"column":18}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":19},"generated":{"line":20,"column":22}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":53},"generated":{"line":20,"column":23}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":71},"generated":{"line":20,"column":41}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":23,"column":72},"generated":{"line":20,"column":42}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":25,"column":2},"generated":{"line":21,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":25,"column":6},"generated":{"line":21,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":25,"column":7},"generated":{"line":21,"column":7}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":25,"column":14},"generated":{"line":21,"column":14}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":25,"column":16},"generated":{"line":21,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":26,"column":4},"generated":{"line":22,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":26,"column":11},"generated":{"line":22,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":26,"column":20},"generated":{"line":22,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":27,"column":0},"generated":{"line":23,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":28,"column":2},"generated":{"line":24,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":28,"column":8},"generated":{"line":24,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":28,"column":14},"generated":{"line":24,"column":14}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":28,"column":55},"generated":{"line":24,"column":17}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":28,"column":55},"generated":{"line":24,"column":18}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":28,"column":57},"generated":{"line":24,"column":19}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":2},"generated":{"line":25,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":7},"generated":{"line":25,"column":7}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":13},"generated":{"line":25,"column":13}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":16},"generated":{"line":25,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":17},"generated":{"line":25,"column":17}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":26},"generated":{"line":25,"column":26}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":28},"generated":{"line":25,"column":28}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":35},"generated":{"line":25,"column":35}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":36},"generated":{"line":25,"column":36}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":38},"generated":{"line":25,"column":37}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":41},"generated":{"line":25,"column":41}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":48},"generated":{"line":25,"column":48}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":30,"column":50},"generated":{"line":25,"column":50}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":4},"generated":{"line":26,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":10},"generated":{"line":26,"column":10}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":14},"generated":{"line":26,"column":13}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":16},"generated":{"line":26,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":22},"generated":{"line":26,"column":22}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":23},"generated":{"line":26,"column":23}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":32},"generated":{"line":26,"column":32}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":34},"generated":{"line":26,"column":33}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":38},"generated":{"line":26,"column":38}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":44},"generated":{"line":26,"column":44}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":45},"generated":{"line":26,"column":45}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":54},"generated":{"line":26,"column":54}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":54},"generated":{"line":26,"column":55}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":58},"generated":{"line":26,"column":58}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":60},"generated":{"line":26,"column":60}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":31,"column":61},"generated":{"line":26,"column":61}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":4},"generated":{"line":27,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":7},"generated":{"line":27,"column":7}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":8},"generated":{"line":27,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":12},"generated":{"line":27,"column":12}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":13},"generated":{"line":27,"column":13}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":13},"generated":{"line":27,"column":17}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":30},"generated":{"line":27,"column":41}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":31},"generated":{"line":27,"column":43}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":38},"generated":{"line":27,"column":50}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":39},"generated":{"line":27,"column":51}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":32,"column":40},"generated":{"line":27,"column":52}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":33,"column":0},"generated":{"line":28,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":35,"column":2},"generated":{"line":29,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":35,"column":9},"generated":{"line":29,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":35,"column":15},"generated":{"line":29,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":36,"column":0},"generated":{"line":30,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":38,"column":0},"generated":{"line":32,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":39,"column":0},"generated":{"line":33,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":40,"column":0},"generated":{"line":34,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":41,"column":7},"generated":{"line":35,"column":0}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":41,"column":16},"generated":{"line":35,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":41,"column":41},"generated":{"line":35,"column":34}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":42,"column":2},"generated":{"line":35,"column":35}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":42,"column":6},"generated":{"line":35,"column":39}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":43,"column":2},"generated":{"line":35,"column":41}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":43,"column":12},"generated":{"line":35,"column":51}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":44,"column":2},"generated":{"line":35,"column":53}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":44,"column":15},"generated":{"line":35,"column":66}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":45,"column":2},"generated":{"line":35,"column":68}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":45,"column":7},"generated":{"line":35,"column":73}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":46,"column":2},"generated":{"line":35,"column":75}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":46,"column":6},"generated":{"line":35,"column":79}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":35,"column":81}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":47,"column":6},"generated":{"line":35,"column":85}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":48,"column":2},"generated":{"line":35,"column":87}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":48,"column":11},"generated":{"line":35,"column":96}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":49,"column":8},"generated":{"line":35,"column":98}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":2},"generated":{"line":36,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":8},"generated":{"line":36,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":8},"generated":{"line":36,"column":23}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":27},"generated":{"line":36,"column":26}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":27},"generated":{"line":36,"column":30}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":61},"generated":{"line":36,"column":31}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":79},"generated":{"line":36,"column":49}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":50,"column":80},"generated":{"line":36,"column":50}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":51,"column":2},"generated":{"line":37,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":51,"column":8},"generated":{"line":37,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":51,"column":16},"generated":{"line":37,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":52,"column":4},"generated":{"line":37,"column":18}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":52,"column":20},"generated":{"line":37,"column":33}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":6},"generated":{"line":37,"column":38}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":11},"generated":{"line":37,"column":42}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":40},"generated":{"line":37,"column":43}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":58},"generated":{"line":37,"column":61}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":60},"generated":{"line":37,"column":62}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":62},"generated":{"line":37,"column":65}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":66},"generated":{"line":37,"column":69}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":69},"generated":{"line":37,"column":72}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":69},"generated":{"line":37,"column":73}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":104},"generated":{"line":37,"column":74}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":53,"column":105},"generated":{"line":37,"column":75}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":2},"generated":{"line":38,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":8},"generated":{"line":38,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":8},"generated":{"line":38,"column":17}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":20},"generated":{"line":38,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":23}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":33}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":37}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":50}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":54}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":58}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":55,"column":21},"generated":{"line":38,"column":60}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":8}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":18}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":21}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":28}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":29}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":32}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":33}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":42}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":56,"column":21},"generated":{"line":39,"column":43}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":58,"column":21},"generated":{"line":40,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":58,"column":21},"generated":{"line":40,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":58,"column":21},"generated":{"line":40,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":58,"column":21},"generated":{"line":40,"column":18}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":10}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":13}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":21}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":24}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":59,"column":21},"generated":{"line":41,"column":34}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":12}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":25}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":60,"column":21},"generated":{"line":42,"column":27}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":61,"column":21},"generated":{"line":42,"column":28}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":61,"column":21},"generated":{"line":42,"column":37}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":62,"column":21},"generated":{"line":42,"column":39}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":19}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":27}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":28}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":31}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":33}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":38}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":43,"column":39}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":19}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":27}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":28}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":31}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":33}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":38}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":64,"column":21},"generated":{"line":44,"column":39}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":13}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":21}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":26}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":30}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":65,"column":21},"generated":{"line":45,"column":31}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":18}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":19}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":22}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":26}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":66,"column":21},"generated":{"line":46,"column":31}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":67,"column":21},"generated":{"line":47,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":67,"column":21},"generated":{"line":47,"column":10}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":67,"column":21},"generated":{"line":47,"column":12}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":67,"column":21},"generated":{"line":47,"column":19}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":67,"column":21},"generated":{"line":47,"column":20}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":68,"column":21},"generated":{"line":48,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":68,"column":21},"generated":{"line":48,"column":5}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":69,"column":21},"generated":{"line":48,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":69,"column":21},"generated":{"line":48,"column":7}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":70,"column":21},"generated":{"line":49,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":70,"column":21},"generated":{"line":49,"column":3}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":70,"column":21},"generated":{"line":49,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":12}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":15}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":25}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":71,"column":21},"generated":{"line":50,"column":27}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":72,"column":21},"generated":{"line":50,"column":28}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":72,"column":21},"generated":{"line":50,"column":37}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":73,"column":21},"generated":{"line":50,"column":39}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":74,"column":21},"generated":{"line":51,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":74,"column":21},"generated":{"line":51,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":74,"column":21},"generated":{"line":51,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":74,"column":21},"generated":{"line":51,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":75,"column":21},"generated":{"line":52,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":75,"column":21},"generated":{"line":52,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":75,"column":21},"generated":{"line":52,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":75,"column":21},"generated":{"line":52,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":76,"column":21},"generated":{"line":53,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":76,"column":21},"generated":{"line":53,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":76,"column":21},"generated":{"line":53,"column":13}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":76,"column":21},"generated":{"line":53,"column":14}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":77,"column":21},"generated":{"line":54,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":77,"column":21},"generated":{"line":54,"column":9}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":77,"column":21},"generated":{"line":54,"column":11}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":77,"column":21},"generated":{"line":54,"column":16}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":78,"column":21},"generated":{"line":55,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":79,"column":21},"generated":{"line":56,"column":4}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":79,"column":21},"generated":{"line":56,"column":5}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":80,"column":21},"generated":{"line":56,"column":6}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":80,"column":21},"generated":{"line":56,"column":7}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":81,"column":21},"generated":{"line":57,"column":2}},{"source":"../../../src/metrics/metric-summary.ts","name":null,"original":{"line":82,"column":21},"generated":{"line":58,"column":0}}],"sources":{"../../../src/metrics/metric-summary.ts":"import type { MeasurementUnit, Span } from '@sentry/types';\nimport type { MetricSummary } from '@sentry/types';\nimport type { Primitive } from '@sentry/types';\nimport { dropUndefinedKeys } from '@sentry/utils';\nimport type { MetricType } from './types';\n\n/**\n * key: bucketKey\n * value: [exportKey, MetricSummary]\n */\ntype MetricSummaryStorage = Map<string, [string, MetricSummary]>;\n\nconst METRICS_SPAN_FIELD = '_sentryMetrics';\n\ntype SpanWithPotentialMetrics = Span & {\n  [METRICS_SPAN_FIELD]?: MetricSummaryStorage;\n};\n\n/**\n * Fetches the metric summary if it exists for the passed span\n */\nexport function getMetricSummaryJsonForSpan(span: Span): Record<string, Array<MetricSummary>> | undefined {\n  const storage = (span as SpanWithPotentialMetrics)[METRICS_SPAN_FIELD];\n\n  if (!storage) {\n    return undefined;\n  }\n  const output: Record<string, Array<MetricSummary>> = {};\n\n  for (const [, [exportKey, summary]] of storage) {\n    const arr = output[exportKey] || (output[exportKey] = []);\n    arr.push(dropUndefinedKeys(summary));\n  }\n\n  return output;\n}\n\n/**\n * Updates the metric summary on a span.\n */\nexport function updateMetricSummaryOnSpan(\n  span: Span,\n  metricType: MetricType,\n  sanitizedName: string,\n  value: number,\n  unit: MeasurementUnit,\n  tags: Record<string, Primitive>,\n  bucketKey: string,\n): void {\n  const existingStorage = (span as SpanWithPotentialMetrics)[METRICS_SPAN_FIELD];\n  const storage =\n    existingStorage ||\n    ((span as SpanWithPotentialMetrics)[METRICS_SPAN_FIELD] = new Map<string, [string, MetricSummary]>());\n\n  const exportKey = `${metricType}:${sanitizedName}@${unit}`;\n  const bucketItem = storage.get(bucketKey);\n\n  if (bucketItem) {\n    const [, summary] = bucketItem;\n    storage.set(bucketKey, [\n      exportKey,\n      {\n        min: Math.min(summary.min, value),\n        max: Math.max(summary.max, value),\n        count: (summary.count += 1),\n        sum: (summary.sum += value),\n        tags: summary.tags,\n      },\n    ]);\n  } else {\n    storage.set(bucketKey, [\n      exportKey,\n      {\n        min: value,\n        max: value,\n        count: 1,\n        sum: value,\n        tags,\n      },\n    ]);\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"b32fed1aad8bf7db7b98e44bb515e110","cacheData":{"env":{}}}